<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Homework</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Fixed Back Button oben links -->
    <div class="top-buttons-fixed-left">
        <a href="/class_details_teacher/{{ class_id }}/{{ teacher_id }}" class="button">Back to Class</a>
    </div>

    <h1>Edit Homework: {{ homework['title'] }}</h1>

    <form method="POST" id="edit-form" style="padding-bottom:90px;">
        <input type="hidden" name="class_id" value="{{ homework['class_id'] }}">
        <input type="hidden" name="teacher_id" value="{{ session['teacher_id'] }}">

        {% for question in questions %}
            <fieldset>
                <legend>Question {{ loop.index }}</legend>
                <div style="margin-bottom:6px; color:#555;">
                    <strong>Skill Level:</strong>
                    {% if question['skill_level'] == 1 %}
                        1–3
                    {% elif question['skill_level'] == 4 %}
                        4–7
                    {% elif question['skill_level'] == 8 %}
                        8–10
                    {% else %}
                        {{ question['skill_level'] }}
                    {% endif %}
                </div>
                <input type="hidden" name="question_ids" value="{{ question['id'] }}">
                
                <label>Question:</label>
                <input type="text" name="questions" value="{{ question['question'] }}" required>

                <label>Answer Options (separated by commas):</label>
                <input type="text" name="options" value="{{ ', '.join(json.loads(question['options'])) }}" required>

                <label>Correct Answer (Index):</label>
                <input type="number" name="correct_answers" value="{{ question['correct_answer'] }}" required>

                <label>Explanation:</label>
                <textarea name="explanations" required>{{ question['explanation'] }}</textarea>

                <label>Question Type:</label>
                <select name="taxonomies" required>
                    <option value="Remembering" {% if question['taxonomy'] == 'Remembering' %}selected{% endif %}>Remembering</option>
                    <option value="Understanding" {% if question['taxonomy'] == 'Understanding' %}selected{% endif %}>Understanding</option>
                    <option value="Applying" {% if question['taxonomy'] == 'Applying' %}selected{% endif %}>Applying</option>
                    <option value="Analyzing" {% if question['taxonomy'] == 'Analyzing' %}selected{% endif %}>Analyzing</option>
                </select>
                <input type="hidden" name="skill_levels" value="{{ question['skill_level'] }}">
            </fieldset>
        {% endfor %}

        {% if open_questions %}
            <h2>Open Questions</h2>
            {% for oq in open_questions %}
                <fieldset>
                    <legend>Open Question {{ loop.index }}</legend>
                    <div style="margin-bottom:6px; color:#555;">
                        <strong>Skill Level:</strong>
                        {% if oq['skill_level'] == 1 %}
                            1–3
                        {% elif oq['skill_level'] == 4 %}
                            4–7
                        {% elif oq['skill_level'] == 8 %}
                            8–10
                        {% else %}
                            {{ oq['skill_level'] }}
                        {% endif %}
                    </div>
                    <input type="hidden" name="open_question_ids" value="{{ oq['id'] }}">
                    <label>Question:</label>
                    <input type="text" name="open_questions" value="{{ oq['question'] }}" required>
                    <label>Sample Solution:</label>
                    <textarea name="sample_solutions" required>{{ oq['sample_solution'] }}</textarea>
                    <label>Taxonomy:</label>
                    <select name="open_taxonomies" required>
                        <option value="Remembering" {% if oq['taxonomy'] == 'Remembering' %}selected{% endif %}>Remembering</option>
                        <option value="Understanding" {% if oq['taxonomy'] == 'Understanding' %}selected{% endif %}>Understanding</option>
                        <option value="Applying" {% if oq['taxonomy'] == 'Applying' %}selected{% endif %}>Applying</option>
                        <option value="Analysing" {% if oq['taxonomy'] == 'Analysing' %}selected{% endif %}>Analysing</option>
                        <option value="Evaluating" {% if oq['taxonomy'] == 'Evaluating' %}selected{% endif %}>Evaluating</option>
                        <option value="Creating" {% if oq['taxonomy'] == 'Creating' %}selected{% endif %}>Creating</option>
                    </select>
                </fieldset>
            {% endfor %}
        {% endif %}

        <!-- Save Buttons: jetzt nicht mehr hier, sondern unten als fixed -->
    </form>

    <!-- Fixed Save Buttons unten -->
    <div class="bottom-buttons-fixed">
        <button type="submit" form="edit-form" name="save" class="submit-button">Save as Draft</button>
        <button type="submit" form="edit-form" name="publish" class="submit-button">Save and Publish</button>
    </div>
</body>
</html>